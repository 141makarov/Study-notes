# 态势感知
## 态势感知
### 存在理由
* “黑天鹅事件”无法预测，只有通过事后的智慧将其合理化。然而，组织机构仍能模拟或概念化某些影响严重的低概率场景，制定事件响应计划。
* 解决方案并不能覆盖整个威胁格局，因为这些解决方案无法对未知威胁进行防御。
### 定义
* 态势感知是对环境中元素的感知，理解其中的深层含义，并在不久的将来预测状态。
### 三个阶段
* 态势认知是了解当前的状态，包括状态识别与确认（攻击发现），以及对态势认知所需信息来源和素材的质量评价。
* 态势理解则包括了解攻击的影响、攻击者（对手）的行为和当前态势发生的原因及方式。简单可概括为：损害评估、行为分析（攻击行为的趋势与意图分析）和因果分析（包括溯源分析和取证分析）。
* 态势预测则是对态势发展情况的预测评估，主要包括态势演化（态势跟踪）和影响评估（情境推演）
## 威胁情报
### 意义
* 战略性和操作性网络威胁情报提供了培养公司整体网络风险感知的指南
* 就像商业情报对销售、财务、市场营销的意义
## 网络态势感知
### 内容
* 网络态势感知中的感知、理解和预测元素能有效追踪、分析并提供有关新兴威胁、威胁攻击者、漏洞和恶意软件有关的可操作情报。
* 大规模网络环境中对能够引起网络态势发生变化的安全要素进行获取、理解、显示以及最近发展趋势的顺延性预测，而最终的目的是要进行决策与行动
### 网络分析
> 浅谈基于数据分析的网络态势感知

* 网络分析技术
    * SNMP
    * RMON(由SNMP扩展而来)
    * NetFlow vs sFlow vs NetStream
    * sFlow
    * NetStream
    * NetFlow的其它替代方案
        * CERT YAT(Yet Another Flowmeter)
        * softflowd
        * QoSient Argus
    * 协议和用户识别
        * “网络流量分类，研究进展与展望”论文
* 网络数据可视化
    * 面向故障诊断
        * 抓包工具：tcpdump、TShark、 WinDump
        * 图形化工具：wireshark(客户端)、ntopng(webUI)
        * 自定义编程：R、Python(Python-Scapy)、Graphviz工具包
    * 面向安全分析
        * 流向&协议：新一代Ntopng网络流量监控—可视化和架构分析
        * 地理位置服务，根据IP地址确定改地址的物理位置信息（坐标）：MaxMind GeoIP
        * 安全威胁情报服务，通过信息共享渠道了解识别攻击者的来源、类型和安全厂商确认情况，做到知己知彼。
### 网络安全态势感知相关技术
> 大数据环境下网络安全态势感知研究 | 36大数据

* 数据融合技术
    * 是一个多级、 多层面的数据处理过程， 主要完成对来自网络中具有相似或不同特征模式的多源信息进行互补集成， 完成对数据的自动监测、 关联、 相关、 估计及组合等处理， 从而得到更为准确、 可靠的结论。 
    * 信息抽象程度
        *  数据级融合
        *  特征级融合
        * 决策级融合
* 数据挖掘技术
    * 就是指从大量的数据中挖掘出有用的信息， 即从大量的、 不完全的、 有噪声的、 模糊的、 随机的实际应用数据中发现隐含的、 规律的、 事先未知的， 但又有潜在用处的并且最终可理解的信息和知识的非平凡过程（ NontrivialProcess）
    * 分类
        * 描述性挖掘用于刻画数据库中数据的一般特性
        *  预测性挖掘在当前数据上进行推断， 并加以预测
    * 方法
        * 关联分析法用于挖掘数据之间的联系
        * 序列模式分析法侧重于分析数据间的因果关系
        * 分类分析法通过对预先定义好的类建立分析模型， 对数据进行分类， 常用的模型有决策树模型、 贝叶斯分类模型、 神经网络模型等
        * 聚类分析不依赖预先定义好的类， 它的划分是未知的， 常用的方法有模糊聚类法、 动态聚类法、 基于密度的方法等
* 特征提取技术
    * 是通过一系列数学方法处理， 将大规模网络安全信息归并融合成一组或者几组在一定值域范围内的数值， 这些数值具有表现网络实时运行状况的一系列特征， 用以反映网络安全状况和受威胁程度等情况
    * 方法
        * 层次分析法
        *  模糊层次分析法
        *  德尔菲法
        * 综合分析法
*  态势预测技术
    * 神经网络预测法
    * 时间序列预测法
    * 基于灰色理论预测法
* 基于多源日志的网络安全态势感知
    * 基于多源日志的网络安全态势感知要素获取
        * 网络入口处防火墙日志
        * 入侵检测日志
        * 网络中关键主机日志
        * 主机漏洞信息
    *  利用大数据进行多源日志分析处理
        * 关联分析
         * > 网络中的防火墙日志和入侵检测日志都是对进入网络的安全事件的流量的刻画， 针对某一个可能的攻击事件， 会产生大量的日志和相关报警记录，这些记录存在着很多的冗余和关联， 因此首先要对得到的原始日志进行单源上的关联分析， 把海量的原始日志转换为直观的、 能够为人所理解的、 可能对网络造成危害的安全事件。 基于多源日志的网络安全态势感知采用基于相似度的报警关联， 可以较好地控制关联后的报警数量， 有利于减少复杂度。 其处理过程是： 首先提取报警日志中的主要属性， 形成原始报警； 再通过重复报警聚合， 生成聚合报警； 对聚合报警的各个属性定义相似度的计算方法， 并分配权重； 计算两个聚合报警的相似度， 通过与相似度阀值的比较， 来决定是否对聚合报警进行超报警； 最终输出属于同一类报警的地址范围和报警信息， 生成安全事件。

            * 首先提取报警日志中的主要属性， 形成原始报警
            * 再通过重复报警聚合， 生成聚合报警
            * 对聚合报警的各个属性定义相似度的计算方法， 并分配权重
            * 计算两个聚合报警的相似度， 通过与相似度阀值的比较， 来决定是否对聚合报警进行超报警
            *  最终输出属于同一类报警的地址范围和报警信息， 生成安全事件
        * 融合分析
         * > 多源日志存在冗余性、 互补性等特点，态势感知借助数据融合技术， 能够使得多个数据源之间取长补短， 从而为感知过程提供保障， 以便更准确地生成安全态势。 经过单源日志报警关联过程， 分别得到各自的安全事件。 而对于来自防火墙和入侵检测的日志的多源安全事件， 采用D-S证据理论（由Dempster于1967年提出， 后由Shafer于1976年加以推广和发展而得名） 方法进行融合判别， 对安全事件的可信度进行评估， 进一步提高准确率， 减少误报。 D-S证据理论应用到安全事件融合的基本思路： 首先研究一种切实可行的初始信任分配方法， 对防火墙和入侵检测分配信息度函数； 然后通过D-S的合成规则， 得到融合之后的安全事件的可信度。

            *  首先研究一种切实可行的初始信任分配方法， 对防火墙和入侵检测分配信息度函数
            *  然后通过D-S的合成规则， 得到融合之后的安全事件的可信度
        * 态势要素分析
         * > 通过对网络入口处安全设备日志的安全分析， 得到的只是进入目标网络的可能的攻击信息， 而真正对网络安全状况产生决定性影响的安全事件， 则需要通过综合分析攻击知识库和具体的网络环境进行最终确认

            * 步骤
                *  一是通过对大量网络攻击实例的研究， 得到可用的攻击知识库， 主要包括各种网络攻击的原理、 特点， 以及它们的作用环境等
                * 二是分析关键主机上存在的系统漏洞和承载的服务的可能漏洞， 建立当前网络环境的漏洞知识库， 分析当前网络环境的拓扑结构、 性能指标等， 得到网络环境知识库
                *  三是通过漏洞知识库来确认安全事件的有效性， 也即对当前网络产生影响的网络攻击事件
            * 态势要素
                * 整个网络面临的安全威胁
                * 分支网络面临的安全威胁
                * 主机受到的安全威胁
                * 威胁的程度
### 可视化
* 数字冰雹
* > 网络态势大数据可视化系统

    * 安全态势感知
        * 网络节点态势，二三维地理空间呈现
        * 网络逻辑架构，二三维拓扑结构呈现
        * 网络节点信息详细呈现
        * 实时监测，灵活告警
        * APT高级威胁展示
    * 数据中心运维可视化
        * 环境可视化
        * 资产可视化
        * 运行状态可视化
        * IT架构可视化
    * 信息资产监测
        * 信息资产组成结构展示
        * 信息流动及作业机理展示
        * 信息资产安全事件监测
    * 安全决策驾驶舱
        * 多维度指标体系
        * 实时数据监控
        * 多种数据展示方式
    * 安全数据情报分析
    * 独创的大屏多屏操控模式
        * 多屏拼控，显示内容自由布局组合
        * 全屏PAD操控
### 相关计划
* 爱因斯坦计划综述

*XMind: ZEN - Trial Version*